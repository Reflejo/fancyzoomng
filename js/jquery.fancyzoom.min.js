jQuery.fancyHide=function(){$('.zoom_close').click()};jQuery.fn.fancyZoom=function(m){var m=m||{};var n=m.directory||'images';var o=m.main_class||'';var p=false;var q=$.browser.msie?'gif':'png';var r=n+'/box.'+q;var s=n+'/sides.'+q;var t=$('<div class="zoom '+o+'" style="display: none; z-index: 10">'+'<table class="zoom_table" style="border-collapse:collapse; width:100%; height:100%;">'+'<tbody>'+'<tr>'+'<td style="background:url('+r+') 0 0 no-repeat; width:26px; height:26px; overflow:hidden;"></td>'+'<td style="background:url('+r+') 0 -52px repeat-x; height:26px; overflow:hidden;"></td>'+'<td style="background:url('+r+') 0 -110px no-repeat; width:26px; height:26px; overflow:hidden;"></td>'+'</tr>'+'<tr>'+'<td style="background:url('+s+') 0 0 repeat-y; width:26px; overflow:hidden;"></td>'+'<td style="background:#fff; vertical-align:top; padding:10px;" class="mainfz">'+'<div class="zoom_content"></div>'+'</td>'+'<td style="background:url('+s+') -28px 0 repeat-y;  width:26px; overflow:hidden;"></td>'+'</tr>'+'<tr>'+'<td style="background:url('+r+') 0 -26px no-repeat; width:26px; height:26px; overflow:hidden;"></td>'+'<td style="background:url('+r+') 0 -78px repeat-x; height:26px; overflow:hidden;"></td>'+'<td style="background:url('+r+') 0 -136px no-repeat; width:26px; height:20px; overflow:hidden;"></td>'+'</tr>'+'</tbody>'+'</table>'+'<a href="#" title="Close" class="zoom_close" style="position:absolute; top:0px; left:0px;">'+'<img src="'+n+'/closebox.png" alt="Close" style="border:none; margin:0; padding:0;"></td>'+'</a>'+'</div>');$('body').append(t);$('html').click(function(e){if(!$(e.target).hasClass('zoomed')&&$('.zoom:visible').length&&!$(e.target).parents('.zoom').length)hide()});$().keyup(function(a){if(a.keyCode==27&&$('.zoom:visible').length>0)hide()});$('.zoom_close').click(hide);var u=$('.zoom_table');var v=$('.zoom_close');var w=$('.zoom_content');var z=$('td.ml,td.mm,td.mr');var A=function(b){$('.zoom_table td').each(function(i){var a=$(this).css('background-image').replace(/\.(png|gif|none)\"\)$/,'.'+b+'")');$(this).css('background-image',a)});var c=v.children('img');var d=c.attr('src').replace(/\.(png|gif|none)$/,'.'+b);c.attr('src',d)};var B=function(){if($.browser.msie&&parseFloat($.browser.version)>=7){A('gif')}};var C=function(){if($.browser.msie&&$.browser.version>=7){A('png')}};function show(e,b){if(p||$('.zoom:visible').length)return false;p=true;var c=$('<div class="dimmer" style="position:absolute;top:0px"/>').height(Math.max($('body').height(),$(document).height()));var f=window.document;var x=window.pageXOffset||(f.documentElement.scrollLeft||f.body.scrollLeft);var y=window.pageYOffset||(f.documentElement.scrollTop||f.body.scrollTop);var d={'width':$(window).width(),'height':$(window).height(),'x':x,'y':y};var g=parseInt(m.width||b.width())+60;var h=parseInt(m.height||b.height())+60;w.height(h-120);var i=Math.max((d.height/2)-(h/2)+y,0);var j=(d.width/2)-(g/2);var k=e.pageY;var l=e.pageX;v.attr('curTop',k);v.attr('curLeft',l);v.attr('scaleImg',Boolean(m.scaleImg));$(t).hide().css({position:'absolute',top:k+'px',left:l+'px',width:'1px',height:'1px'});B();v.hide();if(m.closeOnClick){$(t).click(hide)}if(m.scaleImg){w.html(b.html());$('.zoom_content img').css('width','100%')}else{w.empty()}$('body').append(c);$(t).animate({top:i+'px',left:j+'px',opacity:"show",width:g,height:h},500,null,function(){if(!m.scaleImg){if(m.url){if(!$(".zoom_indicator").length)w.append($('<div class="zoom_indicator"/>'));$.ajax({url:m.url,success:function(a){w.html(a)}})}else{w.html(b.html());if(m.onShow)m.onShow()}}C();v.show();p=false});return false}function hide(){if(p)return false;p=true;$('.dimmer').remove();$(t).unbind('click');B();if(v.attr('scaleImg')!='true'){w.empty()}v.hide();$(t).animate({top:v.attr('curTop')+'px',left:v.attr('curLeft')+'px',opacity:"hide",width:'1px',height:'1px'},500,null,function(){if(v.attr('scaleImg')=='true'){w.empty()}C();p=false});return false}this.each(function(i,a){var b=$(m.modal||$(a).attr('href')).hide();$(a).addClass('zoomed');$(a).click(function(e){return show(e,b)})});return this}
